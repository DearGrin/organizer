# first_approval_app

A new Flutter project.

## Getting Started

``предпочитаю держать под рукой``
#watch
flutter packages pub run build_runner watch --delete-conflicting-outputs

### Code Review
``я намеренно дублировал однотипные комментарии по коду, чтобы показать кол-во однотипных моментов``
``повод для holy war: стоит ли заливать в гит кодогенерацию ... я в лагере "нет не стоит" ``

## Архитектура
Как бы это банально ни звучало: CLEAN и SOLID - ориентиры как нужно строить и писать код.
Кратко:
1) разбить проект на слои: data (dto, rest, data base, etc), domain (repo, entities), presentation (ui + bloc)
2) разбить проект на части: 1 файл - 1 класс, 1 класс - 1 функция
3) использовать abstract, mixin, extension
Естественно, все хорошо в меру и как авторам/заказчику приемлемо
Например, чистый CLEAN выглядел бы так:
дата слой:
- делаем запрос на сервер
- получаем dto
- маппим через extension в entity
домейн слой:
- вызываем запрос не сервер (через репо(сборник use case) + use case (1 метод для решения 1 задачи))
- возвращаем entity
presentation слой:
- из ui делаем вызов в блок
- блок вызвыает use case и получает ответ
- показываем ответ в ui
Такая структура увеличивает кол-во кода, условно, в 1,5 - 2 раза (отдельно сущности, мапперы, юз кейсы),
поэтому часто идут на компромиссы и опускают эти части (в сложных случаях это вредит, в простых уменьшает кол-во кода)

## Основные проблемы:
I Даже для небольшого проекта данная структура слишком горизонтальная
Она не отображает связей, зависимостей:
1) не понятно что к чему относится (Например, какой bloc, чем управляет - все блоки вместе, но отдельно от ui)
2) не понятно как проходят процессы (Нет вертикальной структуры, нет разделения по слоям)

II UI разбит на виджеты, но виджеты сложены "в один файл"
В итоге низкая читаемости кода, частые повторения однотипных виджетов, лишние параметры и условия, 
трудоемкость поддержания и масштабируемости:
1) 90% кнопок не имеют коллбэков (при чем используется пустая функция вместо null). 
Те на кнопку нажать можно, а действия никакого не происходит.
Возможно, часть кнопок нужно скрыть...
2) Вместо Icon используется IconButton
3) Лишние условия при построении списоков при малом кол-ве элементов
4) Основые виджеты недостаточно разбиты на части - смешанные процессы инициализии и построения виджетов

III Работа с REST на уровне "мое первое прилоежение на Flutter"
Так никто в продакшн не пишет, хотя да, так тоже работает

IV Репозитории по функционалу смешаны с бизнес логикой 
Переменные и работа с ними, которые отностятся непосредственно к бизнес-логике вынесены в репозитории

V Модели используют @unfreezed вместо @freezed
В комментариях к моделям указал вариант решения

VI Использование bloc и cubit в одном проекте
Жить не мешает, но теряется единообразие кода и подхода к стейт менеджменту

VII Не используются enum
1) низкая масштабируемость
2) низкая читаемость кода
3) длинные контрукции, подверженные ошибкам (забыл кейс, опечатался и тд)


VIII Путь к ассетам прописывается руками вместо кодогенерации
В комментариях к моделям указал вариант решения

## Обратить внимание:
1) ExperimentCardRepository - там ошибка с использованием индексов
2) Принцип присвоения id для групп и элементов - вероятность ошибки там велика
3) ExperimentCardBloc - пример использования enum
4) FileCubit - описание использования mixin для операций с файлами
5) FaApp - требуется тщательный рефакторинг
6) GroupElement - требуется тщательный рефакторинг
7) project_menu - много дублей кнопок (разница только в иконке, а коллбэки пустые)
8) стилей мало - вынести бы их в стандартную тему
9) Приницп верстки списков (где-то используется Row, передаются индексы вместо элементов)

